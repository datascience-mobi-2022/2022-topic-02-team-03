---
title: "tumor_vs_normal_gsea"
author: "Chlo√©"
date: "31/05/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load all recquired packages & data}
#if you haven't yet installed fgsea package, run the following code

#if (!require("BiocManager", quietly = TRUE))
   # install.packages("BiocManager")
#BiocManager::install("fgsea")
library(fgsea)



LUAD_tumor_vs_norm_clean <- readRDS("./data/LUAD_tumor_vs_norm_clean.RDS")
luad.info = LUAD_tumor_vs_norm_clean[["infomatrix"]]


rm(LUAD_tumor_vs_norm_clean)
```

## create a sorted list of p-values from fold change

```{r ranked p-values}

#create a sorted list of p-values from wilcoxon test (see also: data cleanup)
sort = sort(luad.info$p.wilc, decreasing = F)
head(sort)

#finalise ranked p-values dataframe
ranked.pvalues = data.frame(p.wilc = sort)
rownames(ranked.pvalues) = make.names(rownames(luad.info))
summary(ranked.pvalues)

rm(sort)
```

## run GSEA

```{r}
#load genesets
metabolism_list_gs = readRDS("./data/metabolism_list_gs.RDS")
genesets <- readRDS("./data/hallmarks_genesets.rds")

fgsea = fgsea(genesets, ranked.pvalues)
```
