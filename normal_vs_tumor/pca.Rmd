---
title: "focussed"
author: "Felipe St√ºnkel"
date: "30 5 2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = F)
```

```{r load packages & data}
#install.packages("Seurat")

library(ggplot2)
library(scales)
library("gridExtra")
library(gtools)
library(parallel)
library(grid)
library(Seurat)
library(uwot)

LUAD_tumor_vs_norm_clean <- readRDS("./data/LUAD_tumor_vs_norm_clean.RDS")
luad.tumor = LUAD_tumor_vs_norm_clean[["luad.tumor.clean"]]
luad.normal = LUAD_tumor_vs_norm_clean[["luad.normal.clean"]]
luad.anno = LUAD_tumor_vs_norm_clean[["luad.anno"]]
```

```{r PCA}
pca = RunPCA(t(luad.tumor))
summary(pca)
dim(pca)
pc_tumor = as.data.frame(pca@cell.embeddings)

#check for genderspecific clustering in PC1 and PC 2
g.anno.gender = ggplot(pc_tumor, aes(PC_1, PC_2, colour = luad.anno$gender)) + 
  geom_point(size=2)
g.anno.gender

#check for race specific clustering
g.anno.race = ggplot(pc_tumor, aes(PC_1, PC_2, colour = luad.anno$race)) + 
  geom_point(size=2)
g.anno.race

#check for age specific clustering
g.anno.age = ggplot(pc_tumor, aes(PC_1, PC_2, colour = luad.anno$age_at_initial_pathologic_diagnosis)) + 
  geom_point(size=2)
g.anno.age

umap = as.data.frame(umap(pc_tumor))
class(umap)
#View(umap)

ggplot(umap, aes(V1, V2, colour = luad.anno$gender)) + 
  geom_point(size=2)



#pca.var = pca$sdev^2
#pca.var.per = pca.var/sum(pca.var)*100
#barplot(pca.var.per, xlab = "PCs", ylab = "Percent variation")
#plot(pca$x[,1], pca$x[,2], pch = 20, size = .2)
```
